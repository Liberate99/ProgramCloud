webpackJsonp([4],{29:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=n(7),d=o(c),p=n(1),f=o(p),h=n(0),m=o(h),b=n(11),v=o(b),g=n(99),y=o(g),k=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return(0,d.default)(n,["handleGreenFlagClick","handleStopAllClick","onProjectRunStart","onProjectRunStop"]),n.state={projectRunning:!1,turbo:!1},n}return s(t,e),u(t,[{key:"componentDidMount",value:function(){this.props.vm.addListener("PROJECT_RUN_START",this.onProjectRunStart),this.props.vm.addListener("PROJECT_RUN_STOP",this.onProjectRunStop)}},{key:"componentWillUnmount",value:function(){this.props.vm.removeListener("PROJECT_RUN_START",this.onProjectRunStart),this.props.vm.removeListener("PROJECT_RUN_STOP",this.onProjectRunStop)}},{key:"onProjectRunStart",value:function(){this.setState({projectRunning:!0})}},{key:"onProjectRunStop",value:function(){this.setState({projectRunning:!1})}},{key:"handleGreenFlagClick",value:function(e){e.preventDefault(),e.shiftKey?(this.setState({turbo:!this.state.turbo}),this.props.vm.setTurboMode(!this.state.turbo)):this.props.vm.greenFlag()}},{key:"handleStopAllClick",value:function(e){e.preventDefault(),this.props.vm.stopAll()}},{key:"render",value:function(){var e=this.props,t=(e.vm,a(e,["vm"]));return m.default.createElement(y.default,l({},t,{active:this.state.projectRunning,turbo:this.state.turbo,onGreenFlagClick:this.handleGreenFlagClick,onStopAllClick:this.handleStopAllClick}))}}]),t}(m.default.Component);k.propTypes={vm:f.default.instanceOf(v.default)},t.default=k},35:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),d=n(7),p=o(d),f=n(1),h=o(f),m=n(0),b=o(m),v=n(107),g=o(v),y=n(11),k=o(y),w=n(9),S=n(76),_=n(108),C=o(_),x=n(26),O=function(e){function t(e){i(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return(0,p.default)(n,["attachMouseEvents","cancelMouseDownTimeout","detachMouseEvents","handleDoubleClick","handleQuestionAnswered","onMouseUp","onMouseMove","onMouseDown","onStartDrag","onStopDrag","updateRect","questionListener","setCanvas"]),n.state={mouseDownTimeoutId:null,mouseDownPosition:null,isDragging:!1,dragOffset:null,dragId:null,colorInfo:null,question:null},n}return l(t,e),c(t,[{key:"componentDidMount",value:function(){this.attachRectEvents(),this.attachMouseEvents(this.canvas),this.updateRect(),this.renderer=new g.default(this.canvas),this.props.vm.attachRenderer(this.renderer),this.props.vm.runtime.addListener("QUESTION",this.questionListener)}},{key:"shouldComponentUpdate",value:function(e,t){return this.props.width!==e.width||this.props.height!==e.height||this.props.isColorPicking!==e.isColorPicking||this.state.colorInfo!==t.colorInfo||this.state.question!==t.question}},{key:"componentDidUpdate",value:function(e){this.props.isColorPicking&&!e.isColorPicking?this.startColorPickingLoop():!this.props.isColorPicking&&e.isColorPicking&&this.stopColorPickingLoop()}},{key:"componentWillUnmount",value:function(){this.detachMouseEvents(this.canvas),this.detachRectEvents(),this.stopColorPickingLoop()}},{key:"questionListener",value:function(e){this.setState({question:e})}},{key:"handleQuestionAnswered",value:function(e){var t=this;this.setState({question:null},function(){t.props.vm.runtime.emit("ANSWER",e)})}},{key:"startColorPickingLoop",value:function(){var e=this;this.intervalId=setInterval(function(){e.setState({colorInfo:e.getColorInfo(e.pickX,e.pickY)})},30)}},{key:"stopColorPickingLoop",value:function(){clearInterval(this.intervalId)}},{key:"attachMouseEvents",value:function(e){document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("touchmove",this.onMouseMove),document.addEventListener("touchend",this.onMouseUp),e.addEventListener("mousedown",this.onMouseDown),e.addEventListener("touchstart",this.onMouseDown)}},{key:"detachMouseEvents",value:function(e){document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("touchmove",this.onMouseMove),document.removeEventListener("touchend",this.onMouseUp),e.removeEventListener("mousedown",this.onMouseDown),e.removeEventListener("touchstart",this.onMouseDown)}},{key:"attachRectEvents",value:function(){window.addEventListener("resize",this.updateRect),window.addEventListener("scroll",this.updateRect)}},{key:"detachRectEvents",value:function(){window.removeEventListener("resize",this.updateRect),window.removeEventListener("scroll",this.updateRect)}},{key:"updateRect",value:function(){this.rect=this.canvas.getBoundingClientRect()}},{key:"getScratchCoords",value:function(e,t){var n=this.renderer.getNativeSize();return[n[0]/this.rect.width*(e-this.rect.width/2),n[1]/this.rect.height*(t-this.rect.height/2)]}},{key:"getColorInfo",value:function(e,t){return u({x:e,y:t},this.renderer.extractColor(e,t,20))}},{key:"handleDoubleClick",value:function(e){var t=(0,S.getEventXY)(e),n=t.x,o=t.y,a=[n-this.rect.left,o-this.rect.top],r=this.renderer.pick(a[0],a[1]);if(null!==r){var i=this.props.vm.getTargetIdForDrawableId(r);null!==i&&this.props.vm.setEditingTarget(i)}}},{key:"onMouseMove",value:function(e){var t=(0,S.getEventXY)(e),n=t.x,o=t.y,a=[n-this.rect.left,o-this.rect.top];if(this.pickX=a[0],this.pickY=a[1],null!==this.state.mouseDownTimeoutId&&(this.cancelMouseDownTimeout(),this.state.mouseDown&&!this.state.isDragging&&this.onStartDrag.apply(this,r(this.state.mouseDownPosition))),this.state.mouseDown&&this.state.isDragging){var i=this.getScratchCoords(a[0],a[1]);this.props.vm.postSpriteInfo({x:i[0]+this.state.dragOffset[0],y:-(i[1]+this.state.dragOffset[1]),force:!0})}var s={x:a[0],y:a[1],canvasWidth:this.rect.width,canvasHeight:this.rect.height};this.props.vm.postIOData("mouse",s)}},{key:"onMouseUp",value:function(e){var t=(0,S.getEventXY)(e),n=t.x,o=t.y;if(this.cancelMouseDownTimeout(),this.setState({mouseDown:!1,mouseDownPosition:null}),this.state.isDragging)this.onStopDrag();else{var a={isDown:!1,x:n-this.rect.left,y:o-this.rect.top,canvasWidth:this.rect.width,canvasHeight:this.rect.height};this.props.vm.postIOData("mouse",a)}}},{key:"onMouseDown",value:function(e){this.updateRect();var t=(0,S.getEventXY)(e),n=t.x,o=t.y,a=[n-this.rect.left,o-this.rect.top];0===e.button&&this.setState({mouseDown:!0,mouseDownPosition:a,mouseDownTimeoutId:setTimeout(this.onStartDrag.bind(this,a[0],a[1]),500)});var r={isDown:!0,x:a[0],y:a[1],canvasWidth:this.rect.width,canvasHeight:this.rect.height};if(this.props.vm.postIOData("mouse",r),e.preventDefault&&e.preventDefault(),this.props.isColorPicking){var i=this.state.colorInfo.color,s=i.r,l=i.g,u=i.b,c=function(e){var t=e.toString(16);return 1===t.length?"0"+t:t},d="#"+c(s)+c(l)+c(u);this.props.onDeactivateColorPicker(d),this.setState({colorInfo:null})}}},{key:"cancelMouseDownTimeout",value:function(){null!==this.state.mouseDownTimeoutId&&clearTimeout(this.state.mouseDownTimeoutId),this.setState({mouseDownTimeoutId:null})}},{key:"onStartDrag",value:function(e,t){var n=this.renderer.pick(e,t);if(null!==n){var o=this.renderer.extractDrawable(n,e,t),a=this.props.vm.getTargetIdForDrawableId(n);null!==a&&(this.props.vm.startDrag(a),this.setState({isDragging:!0,dragId:a,dragOffset:o.scratchOffset}))}}},{key:"onStopDrag",value:function(){this.props.vm.stopDrag(this.state.dragId),this.setState({isDragging:!1,dragOffset:null,dragId:null})}},{key:"setCanvas",value:function(e){this.canvas=e}},{key:"render",value:function(){var e=this.props,t=(e.vm,e.onActivateColorPicker,a(e,["vm","onActivateColorPicker"]));return b.default.createElement(C.default,u({canvasRef:this.setCanvas,colorInfo:this.state.colorInfo,question:this.state.question,onDoubleClick:this.handleDoubleClick,onQuestionAnswered:this.handleQuestionAnswered},t))}}]),t}(b.default.Component);O.propTypes={height:h.default.number,isColorPicking:h.default.bool,onActivateColorPicker:h.default.func,onDeactivateColorPicker:h.default.func,vm:h.default.instanceOf(k.default).isRequired,width:h.default.number};var P=function(e){return{isColorPicking:e.colorPicker.active}},E=function(e){return{onActivateColorPicker:function(){return e((0,x.activateColorPicker)())},onDeactivateColorPicker:function(t){return e((0,x.deactivateColorPicker)(t))}}};t.default=(0,w.connect)(P,E)(O)},39:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),d=n(7),p=o(d),f=n(61),h=o(f),m=n(25),b=o(m),v=n(64),g=o(v),y=n(1),k=o(y),w=n(0),S=o(w),_=n(93),C=o(_),x=n(11),O=o(x),P=n(45),E=o(P),T=n(95),R=o(T),j=n(46),M=o(j),L=n(47),D=o(L),I=n(9),B=n(63),N=n(26),A=n(14),W=n(62),U=function(e,t,n){var o=e[t];e[t]=function(){var e=o.apply(this,arguments);return n.apply(this,e),e}},V=function(e){function t(e){i(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.ScratchBlocks=(0,C.default)(e.vm),(0,p.default)(n,["attachVM","detachVM","handleCategorySelected","handlePromptStart","handlePromptCallback","handlePromptClose","handleCustomProceduresClose","onScriptGlowOn","onScriptGlowOff","onBlockGlowOn","onBlockGlowOff","handleExtensionAdded","onTargetsUpdate","onVisualReport","onWorkspaceUpdate","onWorkspaceMetricsChange","setBlocks"]),n.ScratchBlocks.prompt=n.handlePromptStart,n.state={workspaceMetrics:{},prompt:null},n.onTargetsUpdate=(0,h.default)(n.onTargetsUpdate,100),n}return l(t,e),c(t,[{key:"componentDidMount",value:function(){this.ScratchBlocks.FieldColourSlider.activateEyedropper_=this.props.onActivateColorPicker,this.ScratchBlocks.Procedures.externalProcedureDefCallback=this.props.onActivateCustomProcedures;var e=(0,b.default)({},t.defaultOptions,this.props.options,{toolbox:this.props.toolboxXML});this.workspace=this.ScratchBlocks.inject(this.blocks,e),U(this.workspace,"translate",this.onWorkspaceMetricsChange),U(this.workspace,"zoom",this.onWorkspaceMetricsChange),this.attachVM()}},{key:"shouldComponentUpdate",value:function(e,t){return this.state.prompt!==t.prompt||this.props.isVisible!==e.isVisible||this.props.toolboxXML!==e.toolboxXML||this.props.extensionLibraryVisible!==e.extensionLibraryVisible||this.props.customProceduresVisible!==e.customProceduresVisible}},{key:"componentDidUpdate",value:function(e){if(e.toolboxXML!==this.props.toolboxXML){var t=this.workspace.toolbox_.getSelectedItem().name_;this.workspace.updateToolbox(this.props.toolboxXML),this.workspace.toolbox_.setSelectedCategoryByName(t)}this.props.isVisible!==e.isVisible&&(this.props.isVisible?(this.workspace.setVisible(!0),this.props.vm.refreshWorkspace(),window.dispatchEvent(new Event("resize"))):this.workspace.setVisible(!1))}},{key:"componentWillUnmount",value:function(){this.detachVM(),this.workspace.dispose()}},{key:"attachVM",value:function(){this.workspace.addChangeListener(this.props.vm.blockListener),this.flyoutWorkspace=this.workspace.getFlyout().getWorkspace(),this.flyoutWorkspace.addChangeListener(this.props.vm.flyoutBlockListener),this.flyoutWorkspace.addChangeListener(this.props.vm.monitorBlockListener),this.props.vm.addListener("SCRIPT_GLOW_ON",this.onScriptGlowOn),this.props.vm.addListener("SCRIPT_GLOW_OFF",this.onScriptGlowOff),this.props.vm.addListener("BLOCK_GLOW_ON",this.onBlockGlowOn),this.props.vm.addListener("BLOCK_GLOW_OFF",this.onBlockGlowOff),this.props.vm.addListener("VISUAL_REPORT",this.onVisualReport),this.props.vm.addListener("workspaceUpdate",this.onWorkspaceUpdate),this.props.vm.addListener("targetsUpdate",this.onTargetsUpdate),this.props.vm.addListener("EXTENSION_ADDED",this.handleExtensionAdded)}},{key:"detachVM",value:function(){this.props.vm.removeListener("SCRIPT_GLOW_ON",this.onScriptGlowOn),this.props.vm.removeListener("SCRIPT_GLOW_OFF",this.onScriptGlowOff),this.props.vm.removeListener("BLOCK_GLOW_ON",this.onBlockGlowOn),this.props.vm.removeListener("BLOCK_GLOW_OFF",this.onBlockGlowOff),this.props.vm.removeListener("VISUAL_REPORT",this.onVisualReport),this.props.vm.removeListener("workspaceUpdate",this.onWorkspaceUpdate),this.props.vm.removeListener("targetsUpdate",this.onTargetsUpdate),this.props.vm.removeListener("EXTENSION_ADDED",this.handleExtensionAdded)}},{key:"updateToolboxBlockValue",value:function(e,t){var n=this.workspace.getFlyout().getWorkspace().getBlockById(e);n&&n.inputList[0].fieldRow[0].setValue(t)}},{key:"onTargetsUpdate",value:function(){var e=this;this.props.vm.editingTarget&&["glide","move","set"].forEach(function(t){e.updateToolboxBlockValue(t+"x",e.props.vm.editingTarget.x.toFixed(0)),e.updateToolboxBlockValue(t+"y",e.props.vm.editingTarget.y.toFixed(0))})}},{key:"onWorkspaceMetricsChange",value:function(){var e=this.props.vm.editingTarget;if(e&&e.id){var t=Object.assign({},this.state.workspaceMetrics,r({},e.id,{scrollX:this.workspace.scrollX,scrollY:this.workspace.scrollY,scale:this.workspace.scale}));this.setState({workspaceMetrics:t})}}},{key:"onScriptGlowOn",value:function(e){this.workspace.glowStack(e.id,!0)}},{key:"onScriptGlowOff",value:function(e){this.workspace.glowStack(e.id,!1)}},{key:"onBlockGlowOn",value:function(e){this.workspace.glowBlock(e.id,!0)}},{key:"onBlockGlowOff",value:function(e){this.workspace.glowBlock(e.id,!1)}},{key:"onVisualReport",value:function(e){this.workspace.reportValue(e.id,e.value)}},{key:"onWorkspaceUpdate",value:function(e){if(this.props.vm.editingTarget){var t=this.props.vm.editingTarget,n=this.props.vm.runtime.getBlocksXML(),o=(0,g.default)(t.isStage,t.id,n);this.props.updateToolboxState(o)}this.props.vm.editingTarget&&!this.state.workspaceMetrics[this.props.vm.editingTarget.id]&&this.onWorkspaceMetricsChange(),this.workspace.removeChangeListener(this.props.vm.blockListener);var a=this.ScratchBlocks.Xml.textToDom(e.xml);if(this.ScratchBlocks.Xml.clearWorkspaceAndLoadFromXml(a,this.workspace),this.workspace.addChangeListener(this.props.vm.blockListener),this.props.vm.editingTarget&&this.state.workspaceMetrics[this.props.vm.editingTarget.id]){var r=this.state.workspaceMetrics[this.props.vm.editingTarget.id],i=r.scrollX,s=r.scrollY,l=r.scale;this.workspace.scrollX=i,this.workspace.scrollY=s,this.workspace.scale=l,this.workspace.resize()}}},{key:"handleExtensionAdded",value:function(e){this.ScratchBlocks.defineBlocksWithJsonArray(e.map(function(e){return e.json}));var t=this.props.vm.runtime.getBlocksXML(),n=this.props.vm.editingTarget,o=(0,g.default)(n.isStage,n.id,t);this.props.updateToolboxState(o)}},{key:"handleCategorySelected",value:function(e){this.workspace.toolbox_.setSelectedCategoryByName(e)}},{key:"setBlocks",value:function(e){this.blocks=e}},{key:"handlePromptStart",value:function(e,t,n){this.setState({prompt:{callback:n,message:e,defaultValue:t}})}},{key:"handlePromptCallback",value:function(e){this.state.prompt.callback(e),this.handlePromptClose()}},{key:"handlePromptClose",value:function(){this.setState({prompt:null})}},{key:"handleCustomProceduresClose",value:function(e){this.props.onRequestCloseCustomProcedures(e),this.workspace.refreshToolboxSelection_()}},{key:"render",value:function(){var e=this.props,t=e.customProceduresVisible,n=e.extensionLibraryVisible,o=e.options,r=e.vm,i=(e.isVisible,e.onActivateColorPicker,e.updateToolboxState,e.onActivateCustomProcedures,e.onRequestCloseExtensionLibrary),s=(e.onRequestCloseCustomProcedures,e.toolboxXML,a(e,["customProceduresVisible","extensionLibraryVisible","options","vm","isVisible","onActivateColorPicker","updateToolboxState","onActivateCustomProcedures","onRequestCloseExtensionLibrary","onRequestCloseCustomProcedures","toolboxXML"]));return S.default.createElement("div",null,S.default.createElement(R.default,u({componentRef:this.setBlocks},s)),this.state.prompt?S.default.createElement(E.default,{label:this.state.prompt.message,placeholder:this.state.prompt.defaultValue,title:"新建变量",onCancel:this.handlePromptClose,onOk:this.handlePromptCallback}):null,n?S.default.createElement(M.default,{vm:r,onCategorySelected:this.handleCategorySelected,onRequestClose:i}):null,t?S.default.createElement(D.default,{options:{media:o.media},onRequestClose:this.handleCustomProceduresClose}):null)}}]),t}(S.default.Component);V.propTypes={customProceduresVisible:k.default.bool,extensionLibraryVisible:k.default.bool,isVisible:k.default.bool,onActivateColorPicker:k.default.func,onActivateCustomProcedures:k.default.func,onRequestCloseCustomProcedures:k.default.func,onRequestCloseExtensionLibrary:k.default.func,options:k.default.shape({media:k.default.string,zoom:k.default.shape({controls:k.default.bool,wheel:k.default.bool,startScale:k.default.number}),colours:k.default.shape({workspace:k.default.string,flyout:k.default.string,toolbox:k.default.string,toolboxSelected:k.default.string,scrollbar:k.default.string,scrollbarHover:k.default.string,insertionMarker:k.default.string,insertionMarkerOpacity:k.default.number,fieldShadow:k.default.string,dragShadowOpacity:k.default.number}),comments:k.default.bool}),toolboxXML:k.default.string,updateToolboxState:k.default.func,vm:k.default.instanceOf(O.default).isRequired},V.defaultOptions={zoom:{controls:!0,wheel:!0,startScale:.675},grid:{spacing:40,length:2,colour:"#ddd"},colours:{workspace:"#F9F9F9",flyout:"#F9F9F9",toolbox:"#FFFFFF",toolboxSelected:"#E9EEF2",scrollbar:"#CECDCE",scrollbarHover:"#CECDCE",insertionMarker:"#000000",insertionMarkerOpacity:.2,fieldShadow:"rgba(255, 255, 255, 0.3)",dragShadowOpacity:.6},comments:!1},V.defaultProps={isVisible:!0,options:V.defaultOptions};var F=function(e){return{extensionLibraryVisible:e.modals.extensionLibrary,toolboxXML:e.toolbox.toolboxXML,customProceduresVisible:e.customProcedures.active}},q=function(e){return{onActivateColorPicker:function(t){return e((0,N.activateColorPicker)(t))},onActivateCustomProcedures:function(t,n){return e((0,W.activateCustomProcedures)(t,n))},onRequestCloseExtensionLibrary:function(){e((0,A.closeExtensionLibrary)())},onRequestCloseCustomProcedures:function(t){e((0,W.deactivateCustomProcedures)(t))},updateToolboxState:function(t){e((0,B.updateToolbox)(t))}}};t.default=(0,I.connect)(F,q)(V)},43:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=n(66),d=o(c),p=n(1),f=o(p),h=n(0),m=o(h),b=n(11),v=o(b),g=n(7),y=o(g),k=n(9),w=n(14),S=n(90),_=o(S),C=n(44),x=o(C),O=n(19),P=(o(O),function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return(0,y.default)(n,["handleTabSelect","fullScreenDo","openSaveModal","closeSaveModal"]),n.state={tabIndex:0,fullScreen:!1,saveModalStatus:!1},n}return s(t,e),u(t,[{key:"componentDidMount",value:function(){this.audioEngine=new d.default,this.props.vm.attachAudioEngine(this.audioEngine),this.props.vm.loadProject(this.props.projectData),this.props.vm.setCompatibilityMode(!0),this.props.vm.start()}},{key:"componentWillReceiveProps",value:function(e){this.props.projectData!==e.projectData&&this.props.vm.loadProject(e.projectData)}},{key:"componentWillUnmount",value:function(){this.props.vm.stopAll()}},{key:"handleTabSelect",value:function(e){this.setState({tabIndex:e})}},{key:"fullScreenDo",value:function(){this.setState({fullScreen:!this.state.fullScreen})}},{key:"openSaveModal",value:function(){this.setState({saveModalStatus:!0})}},{key:"closeSaveModal",value:function(){this.setState({saveModalStatus:!1})}},{key:"render",value:function(){var e=this.props,t=e.children,n=(e.projectData,e.vm),o=a(e,["children","projectData","vm"]);return m.default.createElement(x.default,l({closeSaveModal:this.closeSaveModal,enableExtensions:window.location.search.includes("extensions"),fullScreen:this.state.fullScreen,fullScreenDo:this.fullScreenDo,openSaveModal:this.openSaveModal,saveModalStatus:this.state.saveModalStatus,tabIndex:this.state.tabIndex,vm:n,onTabSelect:this.handleTabSelect},o),t)}}]),t}(m.default.Component));P.propTypes=l({},x.default.propTypes,{projectData:f.default.string,vm:f.default.instanceOf(v.default)}),P.defaultProps=x.default.defaultProps;var E=function(){return{}},T=function(e){return{onExtensionButtonClick:function(){return e((0,w.openExtensionLibrary)())}}},R=(0,k.connect)(E,T)(P);t.default=(0,_.default)(R)},44:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},l=n(2),u=o(l),c=n(1),d=o(c),p=n(0),f=o(p),h=n(91),m=n(67),b=o(m),v=n(92),g=o(v),y=n(11),k=o(y),w=n(39),S=o(w),_=n(48),C=o(_),x=n(29),O=o(x),P=n(50),E=o(P),T=n(51),R=o(T),j=n(35),M=o(j),L=n(54),D=o(L),I=(n(18),n(16)),B=o(I),N=n(34),A=o(N),W=n(120),U=o(W),V=n(74),F=o(V),q=n(58),X=o(q),G=n(122),z=o(G),Y=n(123),H=o(Y),K=n(124),Q=o(K),J=n(125),Z=o(J),$=n(126),ee=(o($),function e(){i(this,e),this.previewStateHeight=.8*window.innerHeight-40,this.previewStateWidth=(.8*window.innerHeight-40)/3+.8*window.innerHeight-40,this.previewStateWidth>window.innerWidth&&(this.previewStateWidth=window.innerWidth,this.previewStateHeight=.75*this.previewStateWidth)}),te=new ee,ne=function(e){var t=e.basePath,n=e.children,o=e.closeSaveModal,i=e.enableExtensions,l=e.fullScreenDo,c=e.fullScreen,d=e.saveModalStatus,p=e.openSaveModal,m=e.vm,v=e.onExtensionButtonClick,y=e.onTabSelect,k=e.tabIndex,w=r(e,["basePath","children","closeSaveModal","enableExtensions","fullScreenDo","fullScreen","saveModalStatus","openSaveModal","vm","onExtensionButtonClick","onTabSelect","tabIndex"]);if(n)return f.default.createElement(B.default,w,n);var _={tabs:X.default.tabs,tab:(0,u.default)(g.default.reactTabsTab,X.default.tab),tabList:(0,u.default)(g.default.reactTabsTabList,X.default.tabList),tabPanel:(0,u.default)(g.default.reactTabsTabPanel,X.default.tabPanel),tabPanelSelected:(0,u.default)(g.default.reactTabsTabPanelSelected,X.default.isSelected),tabSelected:(0,u.default)(g.default.reactTabsTabSelected,X.default.isSelected)},x={position:"absolute",top:0,left:0,zIndex:999,width:window.innerWidth,height:window.innerHeight,backgroundColor:"#ffffff",margin:"0 auto",display:"flex"},P={width:te.previewStateWidth};return f.default.createElement(B.default,s({className:X.default.pageWrapper},w),f.default.createElement(U.default,{uploadClick:p}),f.default.createElement(D.default,{closeSaveModal:o,isVisible:d}),f.default.createElement(B.default,{className:X.default.bodyWrapper},f.default.createElement(B.default,{className:X.default.flexWrapper},f.default.createElement(B.default,{className:X.default.editorWrapper},f.default.createElement(h.Tabs,{className:_.tabs,forceRenderTabPanel:!0,selectedTabClassName:_.tabSelected,selectedTabPanelClassName:_.tabPanelSelected,onSelect:y},f.default.createElement(h.TabList,{className:_.tabList},f.default.createElement(h.Tab,{className:_.tab},"脚本"),f.default.createElement(h.Tab,{className:_.tab},"造型"),f.default.createElement(h.Tab,{className:_.tab},"声音")),f.default.createElement(h.TabPanel,{className:_.tabPanel},f.default.createElement(B.default,{className:X.default.blocksWrapper},f.default.createElement(S.default,{grow:1,isVisible:0===k,options:{media:t+"static/blocks-media/"},vm:m})),f.default.createElement(B.default,{className:X.default.extensionButtonContainer},f.default.createElement(A.default,{className:(0,u.default)(X.default.extensionButton,a({},X.default.hidden,!i)),img:z.default,title:"拓展",onClick:v}))),f.default.createElement(h.TabPanel,{className:_.tabPanel},1===k?f.default.createElement(C.default,{vm:m}):null),f.default.createElement(h.TabPanel,{className:_.tabPanel},2===k?f.default.createElement(R.default,{vm:m}):null))),f.default.createElement(B.default,{className:X.default.stageAndTargetWrapper},f.default.createElement("div",{style:c?x:{}},f.default.createElement("div",{style:{margin:"auto"}},f.default.createElement("div",{style:c?P:{}},f.default.createElement(B.default,{className:X.default.stageMenuWrapper},f.default.createElement(O.default,{vm:m}),f.default.createElement(Z.default,{title:""}),f.default.createElement("div",{onClick:l,style:{marginLeft:"auto"}},f.default.createElement("img",{className:X.default.icon,src:c?Q.default:H.default,style:{height:"1.25rem",padding:"0.375rem",width:"1.25rem",boxSizing:"content-box"}})))),f.default.createElement("div",{id:"controlBox",style:c?P:{}},f.default.createElement(B.default,{className:X.default.stageWrapper},f.default.createElement(b.default,{minWidth:F.default.fullSizeMinWidth},f.default.createElement(M.default,{height:c?te.previewStateHeight:F.default.fullStageHeight,shrink:0,vm:m,width:c?te.previewStateWidth:F.default.fullStageWidth})))))),f.default.createElement(B.default,{className:X.default.targetWrapper},f.default.createElement(E.default,{vm:m}))))))};ne.propTypes={basePath:d.default.string,children:d.default.node,closeSaveModal:d.default.func,enableExtensions:d.default.bool,fullScreen:d.default.bool,fullScreenDo:d.default.func,onExtensionButtonClick:d.default.func,onTabSelect:d.default.func,openSaveModal:d.default.func,saveModalStatus:d.default.bool,tabIndex:d.default.number,vm:d.default.instanceOf(k.default).isRequired},ne.defaultProps={basePath:"./"},t.default=ne},45:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),u=o(l),c=n(0),d=o(c),p=n(7),f=o(p),h=n(94),m=o(h),b=function(e){function t(e){a(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return(0,f.default)(n,["handleOk","handleCancel","handleChange","handleKeyPress"]),n.state={inputValue:""},n}return i(t,e),s(t,[{key:"handleKeyPress",value:function(e){"Enter"===e.key&&this.handleOk()}},{key:"handleOk",value:function(){this.props.onOk(this.state.inputValue)}},{key:"handleCancel",value:function(){this.props.onCancel()}},{key:"handleChange",value:function(e){this.setState({inputValue:e.target.value})}},{key:"render",value:function(){return d.default.createElement(m.default,{label:this.props.label,placeholder:this.props.placeholder,title:this.props.title,onCancel:this.handleCancel,onChange:this.handleChange,onKeyPress:this.handleKeyPress,onOk:this.handleOk})}}]),t}(d.default.Component);b.propTypes={label:u.default.string.isRequired,onCancel:u.default.func.isRequired,onOk:u.default.func.isRequired,placeholder:u.default.string,title:u.default.string.isRequired},t.default=b},46:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=n(7),c=o(u),d=n(1),p=o(d),f=n(0),h=o(f),m=n(11),b=o(m),v=n(96),g=o(v),y=n(33),k=o(y),w=n(70),S=o(w),_=function(e){function t(e){a(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return(0,c.default)(n,["handleItemSelect"]),n}return i(t,e),l(t,[{key:"handleItemSelect",value:function(e){var t=this,n=e.extensionURL||prompt("Enter the URL of the extension");n&&(this.props.vm.extensionManager.isExtensionLoaded(n)?this.props.onCategorySelected(e.name):this.props.vm.extensionManager.loadExtensionURL(n).then(function(){t.props.onCategorySelected(e.name)}))}},{key:"render",value:function(){var e=g.default.map(function(e){return s({rawURL:e.iconURL||S.default},e)});return h.default.createElement(k.default,{data:e,title:"拓展模块",visible:this.props.visible,onItemSelected:this.handleItemSelect,onRequestClose:this.props.onRequestClose})}}]),t}(h.default.PureComponent);_.propTypes={onCategorySelected:p.default.func,onRequestClose:p.default.func,visible:p.default.bool,vm:p.default.instanceOf(b.default).isRequired},t.default=_},47:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(7),u=o(l),c=n(25),d=o(c),p=n(1),f=o(p),h=n(0),m=o(h),b=n(97),v=o(b),g=n(68),y=o(g),k=n(9),w=function(e){function t(e){a(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return(0,u.default)(n,["handleAddLabel","handleAddBoolean","handleAddTextNumber","handleCancel","handleOk","setBlocks"]),n}return i(t,e),s(t,[{key:"componentWillUnmount",value:function(){this.workspace&&this.workspace.dispose()}},{key:"setBlocks",value:function(e){var n=this;if(e){this.blocks=e;var o=(0,d.default)({},t.defaultOptions,this.props.options),a=y.default.Blocks.defaultToolbox;y.default.Blocks.defaultToolbox=null,this.workspace=y.default.inject(this.blocks,o),y.default.Blocks.defaultToolbox=a,this.mutationRoot=this.workspace.newBlock("procedures_declaration"),this.mutationRoot.setMovable(!1),this.mutationRoot.setDeletable(!1),this.mutationRoot.contextMenu=!1,this.workspace.addChangeListener(function(){n.mutationRoot.onChangeFn();var e=n.workspace.getMetrics(),t=n.mutationRoot.getRelativeToSurfaceXY(),o=t.x,a=t.y,r=e.viewHeight/2-n.mutationRoot.height/2-a,i=e.viewWidth/2-n.mutationRoot.width/2-o;n.mutationRoot.width>e.viewWidth&&(i=e.viewWidth-n.mutationRoot.width-o),n.mutationRoot.moveBy(i,r)}),this.mutationRoot.domToMutation(this.props.mutator),this.mutationRoot.initSvg(),this.mutationRoot.render()}}},{key:"handleCancel",value:function(){this.props.onRequestClose()}},{key:"handleOk",value:function(){var e=this.mutationRoot?this.mutationRoot.mutationToDom():null;this.props.onRequestClose(e)}},{key:"handleAddLabel",value:function(){this.mutationRoot&&this.mutationRoot.addLabelExternal()}},{key:"handleAddBoolean",value:function(){this.mutationRoot&&this.mutationRoot.addBooleanExternal()}},{key:"handleAddTextNumber",value:function(){this.mutationRoot&&this.mutationRoot.addStringNumberExternal()}},{key:"render",value:function(){return m.default.createElement(v.default,{componentRef:this.setBlocks,onAddBoolean:this.handleAddBoolean,onAddLabel:this.handleAddLabel,onAddTextNumber:this.handleAddTextNumber,onCancel:this.handleCancel,onOk:this.handleOk})}}]),t}(m.default.Component);w.propTypes={mutator:f.default.instanceOf(Element),onRequestClose:f.default.func.isRequired,options:f.default.shape({media:f.default.string,zoom:f.default.shape({controls:f.default.bool,wheel:f.default.bool,startScale:f.default.number}),comments:f.default.bool})},w.defaultOptions={zoom:{controls:!1,wheel:!1,startScale:.9},comments:!1,scrollbars:!0},w.defaultProps={options:w.defaultOptions};var S=function(e){return{mutator:e.customProcedures.mutator}};t.default=(0,k.connect)(S)(w)},48:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=n(1),d=o(c),p=n(0),f=o(p),h=n(7),m=o(h),b=n(18),v=n(11),g=o(v),y=n(28),k=o(y),w=n(98),S=o(w),_=n(49),C=o(_),x=n(9),O=n(14),P=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return(0,m.default)(n,["handleSelectCostume","handleDeleteCostume"]),n.state={selectedCostumeIndex:0},n}return s(t,e),u(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.editingTarget,n=e.sprites,o=e.stage,a=t&&n[t]?n[t]:o;a&&a.costumes&&this.state.selectedCostumeIndex>a.costumes.length-1&&this.setState({selectedCostumeIndex:a.costumes.length-1})}},{key:"handleSelectCostume",value:function(e){this.props.vm.editingTarget.setCostume(e),this.setState({selectedCostumeIndex:e})}},{key:"handleDeleteCostume",value:function(e){this.props.vm.deleteCostume(e)}},{key:"render",value:function(){var e=this.props,t=e.onNewBackdropClick,n=e.onNewCostumeClick,o=a(e,["onNewBackdropClick","onNewCostumeClick"]),r=o.editingTarget,i=o.sprites,s=o.stage,u=r&&i[r]?i[r]:s;if(!u)return null;var c=f.default.createElement(b.FormattedMessage,{defaultMessage:"Add Backdrop",id:"gui.costumeTab.addBackdrop"}),d=f.default.createElement(b.FormattedMessage,{defaultMessage:"Add Costume",id:"gui.costumeTab.addCostume"}),p=u.isStage?c:d,h=u.isStage?t:n;return f.default.createElement(k.default,{buttons:[{message:p,img:S.default,onClick:h}],items:u.costumes||[],selectedItemIndex:this.state.selectedCostumeIndex,onDeleteClick:this.handleDeleteCostume,onItemClick:this.handleSelectCostume},u.costumes?f.default.createElement(C.default,l({},o,{selectedCostumeIndex:this.state.selectedCostumeIndex})):null)}}]),t}(f.default.Component);P.propTypes={editingTarget:d.default.string,onNewBackdropClick:d.default.func.isRequired,onNewCostumeClick:d.default.func.isRequired,sprites:d.default.shape({id:d.default.shape({costumes:d.default.arrayOf(d.default.shape({url:d.default.string,name:d.default.string.isRequired}))})}),stage:d.default.shape({sounds:d.default.arrayOf(d.default.shape({name:d.default.string.isRequired}))}),vm:d.default.instanceOf(g.default)};var E=function(e){return{editingTarget:e.targets.editingTarget,sprites:e.targets.sprites,stage:e.targets.stage,costumeLibraryVisible:e.modals.costumeLibrary,backdropLibraryVisible:e.modals.backdropLibrary}},T=function(e){return{onNewBackdropClick:function(t){t.preventDefault(),e((0,O.openBackdropLibrary)())},onNewCostumeClick:function(t){t.preventDefault(),e((0,O.openCostumeLibrary)())}}};t.default=(0,x.connect)(E,T)(P)},49:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=n(1),c=o(u),d=n(0),p=o(d),f=n(7),h=o(f),m=n(11),b=o(m),v=n(65),g=o(v),y=n(9),k=function(e){function t(e){a(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return(0,h.default)(n,["handleUpdateName","handleUpdateSvg"]),n}return i(t,e),l(t,[{key:"handleUpdateName",value:function(e){this.props.vm.renameCostume(this.props.selectedCostumeIndex,e)}},{key:"handleUpdateSvg",value:function(e,t,n){this.props.vm.updateSvg(this.props.selectedCostumeIndex,e,t,n)}},{key:"render",value:function(){return this.props.svgId?p.default.createElement(g.default,s({},this.props,{svg:this.props.vm.getCostumeSvg(this.props.selectedCostumeIndex),onUpdateName:this.handleUpdateName,onUpdateSvg:this.handleUpdateSvg})):null}}]),t}(p.default.Component);k.propTypes={name:c.default.string,rotationCenterX:c.default.number,rotationCenterY:c.default.number,selectedCostumeIndex:c.default.number.isRequired,svgId:c.default.string,vm:c.default.instanceOf(b.default)};var w=function(e,t){var n=t.selectedCostumeIndex,o=e.targets,a=o.editingTarget,r=o.sprites,i=o.stage,s=a&&r[a]?r[a]:i,l=s&&s.costumes[n];return{name:l&&l.name,rotationCenterX:l&&l.rotationCenterX,rotationCenterY:l&&l.rotationCenterY,svgId:a&&""+a+l.skinId}};t.default=(0,y.connect)(w)(k)},50:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=n(7),d=o(c),p=n(0),f=o(p),h=n(9),m=n(14),b=n(100),v=o(b),g=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return(0,d.default)(n,["handleChangeSpriteDirection","handleChangeSpriteName","handleChangeSpriteRotationStyle","handleChangeSpriteVisibility","handleChangeSpriteX","handleChangeSpriteY","handleDeleteSprite","handleDuplicateSprite","handleSelectSprite"]),n}return s(t,e),u(t,[{key:"handleChangeSpriteDirection",value:function(e){this.props.vm.postSpriteInfo({direction:e})}},{key:"handleChangeSpriteName",value:function(e){this.props.vm.renameSprite(this.props.editingTarget,e)}},{key:"handleChangeSpriteRotationStyle",value:function(e){this.props.vm.postSpriteInfo({rotationStyle:e})}},{key:"handleChangeSpriteVisibility",value:function(e){this.props.vm.postSpriteInfo({visible:e})}},{key:"handleChangeSpriteX",value:function(e){this.props.vm.postSpriteInfo({x:e})}},{key:"handleChangeSpriteY",value:function(e){this.props.vm.postSpriteInfo({y:e})}},{key:"handleDeleteSprite",value:function(e){this.props.vm.deleteSprite(e)}},{key:"handleDuplicateSprite",value:function(e){this.props.vm.duplicateSprite(e)}},{key:"handleSelectSprite",value:function(e){this.props.vm.setEditingTarget(e)}},{key:"render",value:function(){return f.default.createElement(v.default,l({},this.props,{onChangeSpriteDirection:this.handleChangeSpriteDirection,onChangeSpriteName:this.handleChangeSpriteName,onChangeSpriteRotationStyle:this.handleChangeSpriteRotationStyle,onChangeSpriteVisibility:this.handleChangeSpriteVisibility,onChangeSpriteX:this.handleChangeSpriteX,onChangeSpriteY:this.handleChangeSpriteY,onDeleteSprite:this.handleDeleteSprite,onDuplicateSprite:this.handleDuplicateSprite,onSelectSprite:this.handleSelectSprite}))}}]),t}(f.default.Component),y=v.default.propTypes,k=(y.onSelectSprite,a(y,["onSelectSprite"]));g.propTypes=l({},k);var w=function(e){return{editingTarget:e.targets.editingTarget,sprites:Object.keys(e.targets.sprites).reduce(function(t,n){var o=e.targets.sprites[n],r=o.direction,i=o.x,s=o.y,u=a(o,["direction","x","y"]);return void 0!==r&&(r=Math.round(r)),void 0!==i&&(i=Math.round(i)),void 0!==s&&(s=Math.round(s)),t[n]=l({},u,{direction:r,x:i,y:s}),t},{}),stage:e.targets.stage,soundLibraryVisible:e.modals.soundLibrary,spriteLibraryVisible:e.modals.spriteLibrary,costumeLibraryVisible:e.modals.costumeLibrary,backdropLibraryVisible:e.modals.backdropLibrary,workLibraryVisible:e.modals.workLibrary}},S=function(e){return{onNewSpriteClick:function(t){t.preventDefault(),e((0,m.openSpriteLibrary)())},onRequestCloseWorkLibrary:function(){e((0,m.closeWorkLibrary)())},onRequestCloseBackdropLibrary:function(){e((0,m.closeBackdropLibrary)())},onRequestCloseCostumeLibrary:function(){e((0,m.closeCostumeLibrary)())},onRequestCloseSoundLibrary:function(){e((0,m.closeSoundLibrary)())},onRequestCloseSpriteLibrary:function(){e((0,m.closeSpriteLibrary)())}}};t.default=(0,h.connect)(w,S)(g)},51:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=n(1),c=o(u),d=n(0),p=o(d),f=n(7),h=o(f),m=n(18),b=n(11),v=o(b),g=n(28),y=o(g),k=n(73),w=o(k),S=n(101),_=o(S),C=n(102),x=o(C),O=n(52),P=o(O),E=n(53),T=o(E),R=n(9),j=n(14),M=function(e){function t(e){a(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return(0,h.default)(n,["handleSelectSound","handleDeleteSound"]),n.state={selectedSoundIndex:0},n}return i(t,e),l(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.editingTarget,n=e.sprites,o=e.stage,a=t&&n[t]?n[t]:o;a&&a.sounds&&this.state.selectedSoundIndex>a.sounds.length-1&&this.setState({selectedSoundIndex:Math.max(a.sounds.length-1,0)})}},{key:"handleSelectSound",value:function(e){this.setState({selectedSoundIndex:e})}},{key:"handleDeleteSound",value:function(e){this.props.vm.deleteSound(e)}},{key:"render",value:function(){var e=this.props,t=e.vm,n=e.onNewSoundFromLibraryClick,o=e.onNewSoundFromRecordingClick;if(!t.editingTarget)return null;var a=t.editingTarget.sprite,r=a.sounds?a.sounds.map(function(e){return{url:w.default,name:e.name}}):[],i=p.default.createElement(m.FormattedMessage,{defaultMessage:"Record Sound",id:"gui.soundTab.recordSound"}),l=p.default.createElement(m.FormattedMessage,{defaultMessage:"Add Sound",id:"gui.soundTab.addSound"});return p.default.createElement(y.default,{buttons:[{message:i,img:x.default,onClick:o},{message:l,img:_.default,onClick:n}],items:r.map(function(e){return s({url:w.default},e)}),selectedItemIndex:this.state.selectedSoundIndex,onDeleteClick:this.handleDeleteSound,onItemClick:this.handleSelectSound},a.sounds&&a.sounds.length>0?p.default.createElement(T.default,{soundIndex:this.state.selectedSoundIndex}):null,this.props.soundRecorderVisible?p.default.createElement(P.default,null):null)}}]),t}(p.default.Component);M.propTypes={editingTarget:c.default.string,onNewSoundFromLibraryClick:c.default.func.isRequired,onNewSoundFromRecordingClick:c.default.func.isRequired,soundRecorderVisible:c.default.bool,sprites:c.default.shape({id:c.default.shape({sounds:c.default.arrayOf(c.default.shape({name:c.default.string.isRequired}))})}),stage:c.default.shape({sounds:c.default.arrayOf(c.default.shape({name:c.default.string.isRequired}))}),vm:c.default.instanceOf(v.default).isRequired};var L=function(e){return{editingTarget:e.targets.editingTarget,sprites:e.targets.sprites,stage:e.targets.stage,soundRecorderVisible:e.modals.soundRecorder}},D=function(e){return{onNewSoundFromLibraryClick:function(t){t.preventDefault(),e((0,j.openSoundLibrary)())},onNewSoundFromRecordingClick:function(){e((0,j.openSoundRecorder)())}}};t.default=(0,R.connect)(L,D)(M)},52:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(7),u=o(l),c=n(1),d=o(c),p=n(0),f=o(p),h=n(11),m=o(h),b=n(103),v=o(b),g=n(9),y=n(104),k=o(y),w=n(14),S=function(e){function t(e){a(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return(0,u.default)(n,["handleRecord","handleStopRecording","handlePlay","handleStopPlaying","handleBack","handleSubmit","handleCancel","handleSetPlayhead","handleSetTrimStart","handleSetTrimEnd"]),n.state={samples:null,encoding:!1,levels:null,playhead:null,playing:!1,recording:!1,sampleRate:null,trimStart:0,trimEnd:1},n}return i(t,e),s(t,[{key:"handleRecord",value:function(){this.setState({recording:!0})}},{key:"handleStopRecording",value:function(e,t,n,o,a){this.setState({samples:e,sampleRate:t,levels:n,trimStart:o,trimEnd:a,recording:!1})}},{key:"handlePlay",value:function(){this.setState({playing:!0})}},{key:"handleStopPlaying",value:function(){this.setState({playing:!1,playhead:null})}},{key:"handleBack",value:function(){this.setState({playing:!1,samples:null})}},{key:"handleSetTrimEnd",value:function(e){this.setState({trimEnd:e})}},{key:"handleSetTrimStart",value:function(e){this.setState({trimStart:e})}},{key:"handleSetPlayhead",value:function(e){this.setState({playhead:e})}},{key:"handleSubmit",value:function(){var e=this;this.setState({encoding:!0},function(){var t=e.state.samples.length,n=Math.floor(e.state.trimStart*t),o=Math.floor(e.state.trimEnd*t),a=e.state.samples.slice(n,o);v.default.encode({sampleRate:e.state.sampleRate,channelData:[a]}).then(function(t){var n=String(Math.floor(1e5*Math.random())),o={format:"",md5:n+".wav",name:"recording "+e.props.vm.editingTarget.sprite.sounds.length},a=e.props.vm.runtime.storage;a.builtinHelper.cache(a.AssetType.Sound,a.DataFormat.WAV,new Uint8Array(t),n),e.props.vm.addSound(o),e.handleCancel()})})}},{key:"handleCancel",value:function(){this.props.onClose()}},{key:"render",value:function(){return f.default.createElement(k.default,{encoding:this.state.encoding,levels:this.state.levels,playhead:this.state.playhead,playing:this.state.playing,recording:this.state.recording,sampleRate:this.state.sampleRate,samples:this.state.samples,trimEnd:this.state.trimEnd,trimStart:this.state.trimStart,onBack:this.handleBack,onCancel:this.handleCancel,onPlay:this.handlePlay,onRecord:this.handleRecord,onSetPlayhead:this.handleSetPlayhead,onSetTrimEnd:this.handleSetTrimEnd,onSetTrimStart:this.handleSetTrimStart,onStopPlaying:this.handleStopPlaying,onStopRecording:this.handleStopRecording,onSubmit:this.handleSubmit})}}]),t}(f.default.Component);S.propTypes={onClose:d.default.func,vm:d.default.instanceOf(m.default)};var _=function(e){return{vm:e.vm}},C=function(e){return{onClose:function(){e((0,w.closeSoundRecorder)())}}};t.default=(0,g.connect)(_,C)(S)},53:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(7),u=o(l),c=n(1),d=o(c),p=n(0),f=o(p),h=n(9),m=n(75),b=n(105),v=o(b),g=n(106),y=o(g),k=n(77),w=o(k),S=function(e){function t(e){a(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return(0,u.default)(n,["handleStoppedPlaying","handleChangeName","handlePlay","handleStopPlaying","handleUpdatePlayhead","handleActivateTrim","handleUpdateTrimEnd","handleUpdateTrimStart","handleEffect","handleUndo","handleRedo","submitNewSamples"]),n.state={chunkLevels:(0,m.computeChunkedRMS)(n.props.samples),playhead:null,trimStart:null,trimEnd:null},n.redoStack=[],n.undoStack=[],n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.audioBufferPlayer=new w.default(this.props.samples,this.props.sampleRate)}},{key:"componentWillReceiveProps",value:function(e){e.soundId!==this.props.soundId&&(this.redoStack=[],this.undoStack=[],this.resetState(e.samples,e.sampleRate))}},{key:"componentWillUnmount",value:function(){this.audioBufferPlayer.stop()}},{key:"resetState",value:function(e,t){this.audioBufferPlayer.stop(),this.audioBufferPlayer=new w.default(e,t),this.setState({chunkLevels:(0,m.computeChunkedRMS)(e),playhead:null,trimStart:null,trimEnd:null})}},{key:"submitNewSamples",value:function(e,t,n){n||(this.redoStack=[],this.undoStack.push(this.props.samples.slice(0))),this.resetState(e,t),this.props.onUpdateSoundBuffer(this.props.soundIndex,this.audioBufferPlayer.buffer)}},{key:"handlePlay",value:function(){this.audioBufferPlayer.play(this.state.trimStart||0,this.state.trimEnd||1,this.handleUpdatePlayhead,this.handleStoppedPlaying)}},{key:"handleStopPlaying",value:function(){this.audioBufferPlayer.stop(),this.handleStoppedPlaying()}},{key:"handleStoppedPlaying",value:function(){this.setState({playhead:null})}},{key:"handleUpdatePlayhead",value:function(e){this.setState({playhead:e})}},{key:"handleChangeName",value:function(e){this.props.onRenameSound(this.props.soundIndex,e)}},{key:"handleActivateTrim",value:function(){if(null===this.state.trimStart&&null===this.state.trimEnd)this.setState({trimEnd:.95,trimStart:.05});else{var e=this.props.samples.length,t=Math.floor(this.state.trimStart*e),n=Math.floor(this.state.trimEnd*e),o=this.props.samples.slice(t,n);this.submitNewSamples(o,this.props.sampleRate)}}},{key:"handleUpdateTrimEnd",value:function(e){this.setState({trimEnd:e})}},{key:"handleUpdateTrimStart",value:function(e){this.setState({trimStart:e})}},{key:"effectFactory",value:function(e){var t=this;return function(){return t.handleEffect(e)}}},{key:"handleEffect",value:function(e){var t=this;new v.default(this.audioBufferPlayer.buffer,e).process(function(e){var n=e.renderedBuffer,o=n.getChannelData(0),a=n.sampleRate;t.submitNewSamples(o,a),t.handlePlay()})}},{key:"handleUndo",value:function(){this.redoStack.push(this.props.samples.slice(0));var e=this.undoStack.pop();e&&(this.submitNewSamples(e,this.props.sampleRate,!0),this.handlePlay())}},{key:"handleRedo",value:function(){var e=this.redoStack.pop();e&&(this.undoStack.push(this.props.samples.slice(0)),this.submitNewSamples(e,this.props.sampleRate,!0),this.handlePlay())}},{key:"render",value:function(){var e=v.default.effectTypes;return f.default.createElement(y.default,{canRedo:this.redoStack.length>0,canUndo:this.undoStack.length>0,chunkLevels:this.state.chunkLevels,name:this.props.name,playhead:this.state.playhead,trimEnd:this.state.trimEnd,trimStart:this.state.trimStart,onActivateTrim:this.handleActivateTrim,onChangeName:this.handleChangeName,onEcho:this.effectFactory(e.ECHO),onFaster:this.effectFactory(e.FASTER),onLouder:this.effectFactory(e.LOUDER),onPlay:this.handlePlay,onRedo:this.handleRedo,onReverse:this.effectFactory(e.REVERSE),onRobot:this.effectFactory(e.ROBOT),onSetTrimEnd:this.handleUpdateTrimEnd,onSetTrimStart:this.handleUpdateTrimStart,onSlower:this.effectFactory(e.SLOWER),onSofter:this.effectFactory(e.SOFTER),onStop:this.handleStopPlaying,onUndo:this.handleUndo})}}]),t}(f.default.Component);S.propTypes={name:d.default.string.isRequired,onRenameSound:d.default.func.isRequired,onUpdateSoundBuffer:d.default.func.isRequired,sampleRate:d.default.number,samples:d.default.instanceOf(Float32Array),soundId:d.default.string,soundIndex:d.default.number};var _=function(e,t){var n=t.soundIndex,o=e.vm.editingTarget.sprite.sounds[n],a=e.vm.getSoundBuffer(n);return{soundId:o.soundId,sampleRate:a.sampleRate,samples:a.getChannelData(0),name:o.name,onRenameSound:e.vm.renameSound.bind(e.vm),onUpdateSoundBuffer:e.vm.updateSoundBuffer.bind(e.vm)}};t.default=(0,h.connect)(_)(S)},54:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=n(7),c=o(u),d=n(1),p=o(d),f=n(0),h=o(f),m=n(109),b=o(m),v=n(9),g=n(19),y=o(g),k=n(110),w=(o(k),n(111)),S=(o(w),n(112)),_=o(S),C=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return(0,c.default)(n,["handelOnSave","handleChange"]),n.state={workName:""},n}return s(t,e),l(t,[{key:"componentWillMount",value:function(){var e=(0,g.getQueryString)("projectId");if(null!==e&&""!==e){var t={busScratchFile:{id:e}},n=y.default.yunfd_request(y.default.POST,t,"/business.busScratchFile.getName.hsr",null,!1);this.setState({workName:n.name})}}},{key:"handelOnSave",value:function(){var e=this.props.saveProjectSb3(),t=JSON.parse(e).targets[0].costume,n={busScratchFile:{name:this.state.workName,content:e,cover:t.assetId+"."+t.dataFormat,createBy:JSON.parse(y.default.getCookie("loginResult")).id,type:1}},o=(0,g.getQueryString)("projectId");null!==o&&""!==o&&(n.busScratchFile.id=o),y.default.yunfd_request(y.default.POST,n,"/business.busScratchFile.insertOrUpdate.hsr",function(e){_.default.success("保存成功！")}),this.props.closeSaveModal()}},{key:"handleChange",value:function(e){this.setState({workName:e.target.value})}},{key:"render",value:function(){var e=this.props,t=(e.isVisible,e.closeSaveModal);e.saveProjectSb3,a(e,["isVisible","closeSaveModal","saveProjectSb3"]);return h.default.createElement("div",null,this.props.isVisible?h.default.createElement(b.default,{handelOnSave:this.handelOnSave,label:"作品名称（相同名称会覆盖原来作品）",placeholder:"输入作品名称",title:"保存作品",workName:this.state.workName,onCancel:t,onChange:this.handleChange}):null)}}]),t}(h.default.Component);C.propTypes={closeSaveModal:p.default.func,isVisible:p.default.bool,saveClick:p.default.func,saveProjectSb3:p.default.func};var x=function(e){return{saveProjectSb3:e.vm.saveProjectSb3.bind(e.vm)}};t.default=(0,v.connect)(x,function(){return{}})(C)},58:function(e,t,n){var o=n(59);"string"==typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0};a.transform=void 0;n(13)(o,a);o.locals&&(e.exports=o.locals)},59:function(e,t,n){t=e.exports=n(12)(void 0),t.push([e.i,".gui_page-wrapper_1cgy0{height:100%}.gui_body-wrapper_-N0sA{height:calc(100% - 3rem);background-color:#e8edf1}.gui_flex-wrapper_uXHkj{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;height:100%;overflow-y:hidden}.gui_editor-wrapper_2DYcj{-webkit-flex-basis:600px;-ms-flex-preferred-size:600px;flex-basis:600px;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;position:relative;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}.gui_editor-wrapper_2DYcj,.gui_tab-list_87TYM{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.gui_tab-list_87TYM{height:2.75rem;width:250px;-webkit-box-align:end;-webkit-align-items:flex-end;-ms-flex-align:end;align-items:flex-end;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-weight:500;font-size:.8rem;margin:0!important;border-bottom:0!important}.gui_tab_27Unf{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;height:80%;margin-left:1px;border-radius:.5rem .5rem 0 0;border:none;background-color:#f6f8fa;color:#9aa1b5;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.gui_tab_27Unf.gui_is-selected_sHAiu{z-index:1;color:#40b9f5;background-color:#fff;border-bottom:1px solid #e8edf1}.gui_tabs_AgmuP{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}.gui_tab-panel_22sLx,.gui_tabs_AgmuP{position:relative;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}.gui_tab-panel_22sLx{display:none}.gui_tab-panel_22sLx.gui_is-selected_sHAiu{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.gui_blocks-wrapper_1ccgf{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;position:relative}.gui_stage-and-target-wrapper_69KBf{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;max-width:calc(480px + 1rem)}.gui_stage-wrapper_29wQB{padding-left:.5rem;padding-right:.5rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.gui_target-wrapper_36Gbz{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;-webkit-flex-basis:0;-ms-flex-preferred-size:0;flex-basis:0;padding-top:.5rem;padding-left:.5rem;padding-right:.5rem;overflow:hidden}.gui_stage-menu-wrapper_W5Ler,.gui_target-wrapper_36Gbz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.gui_stage-menu-wrapper_W5Ler{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;height:2.75rem;padding:.5rem;width:100%}.gui_extension-button-container_b4rCs{width:3.25rem;height:3.25rem;position:absolute;bottom:0;left:0;z-index:50;background:#fff;border:1px solid #ddd;-webkit-box-sizing:content-box;box-sizing:content-box}.gui_extension-button_2T7PA{font-size:.55rem;font-weight:700}.gui_extension-button_2T7PA>div{margin-top:0}",""]),t.locals={"page-wrapper":"gui_page-wrapper_1cgy0",pageWrapper:"gui_page-wrapper_1cgy0","body-wrapper":"gui_body-wrapper_-N0sA",bodyWrapper:"gui_body-wrapper_-N0sA","flex-wrapper":"gui_flex-wrapper_uXHkj",flexWrapper:"gui_flex-wrapper_uXHkj","editor-wrapper":"gui_editor-wrapper_2DYcj",editorWrapper:"gui_editor-wrapper_2DYcj","tab-list":"gui_tab-list_87TYM",tabList:"gui_tab-list_87TYM",tab:"gui_tab_27Unf","is-selected":"gui_is-selected_sHAiu",isSelected:"gui_is-selected_sHAiu",tabs:"gui_tabs_AgmuP","tab-panel":"gui_tab-panel_22sLx",tabPanel:"gui_tab-panel_22sLx","blocks-wrapper":"gui_blocks-wrapper_1ccgf",blocksWrapper:"gui_blocks-wrapper_1ccgf","stage-and-target-wrapper":"gui_stage-and-target-wrapper_69KBf",stageAndTargetWrapper:"gui_stage-and-target-wrapper_69KBf","stage-wrapper":"gui_stage-wrapper_29wQB",stageWrapper:"gui_stage-wrapper_29wQB","target-wrapper":"gui_target-wrapper_36Gbz",targetWrapper:"gui_target-wrapper_36Gbz","stage-menu-wrapper":"gui_stage-menu-wrapper_W5Ler",stageMenuWrapper:"gui_stage-menu-wrapper_W5Ler","extension-button-container":"gui_extension-button-container_b4rCs",extensionButtonContainer:"gui_extension-button-container_b4rCs","extension-button":"gui_extension-button_2T7PA",extensionButton:"gui_extension-button_2T7PA"}},757:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=n(0),c=o(u),d=n(15),p=o(d),f=n(9),h=n(88),m=o(h),b=n(29),v=o(b),g=n(35),y=o(g),k=n(16),w=o(k),S=n(43),_=o(S),C=n(127),x=o(C),O=function(e){return{vm:e.vm}},P=(0,f.connect)(O)(y.default),E=(0,f.connect)(O)(v.default),T="10015059",R=function(e){function t(e){a(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.updateProject=n.updateProject.bind(n),n.state={projectId:window.location.hash.substring(1)||T},n}return i(t,e),l(t,[{key:"componentDidMount",value:function(){window.addEventListener("hashchange",this.updateProject),window.location.hash.substring(1)||(window.location.hash=T)}},{key:"componentWillUnmount",value:function(){window.addEventListener("hashchange",this.updateProject)}},{key:"updateProject",value:function(){this.setState({projectId:window.location.hash.substring(1)})}},{key:"render",value:function(){return c.default.createElement("div",{style:{display:"flex"}},c.default.createElement(_.default,s({},this.props,{width:480}),c.default.createElement(w.default,{height:40},c.default.createElement(E,{style:{marginRight:10,height:40}})),c.default.createElement(P,{height:360,width:480})),c.default.createElement("iframe",{allowFullScreen:!0,allowTransparency:!0,frameBorder:"0",height:"402",src:"https://scratch.mit.edu/projects/embed/"+this.state.projectId+"/?autostart=true",width:"485"}))}}]),t}(c.default.Component),j=(0,m.default)((0,x.default)(R)),M=document.createElement("div");document.body.appendChild(M),p.default.render(c.default.createElement(j,null),M)}},[757]);